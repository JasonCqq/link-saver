<app-main-sidebar></app-main-sidebar>
<p-toast />

<main>
  <div class="url-title">
    <h1>URL Bank</h1>
    <p style="color: rgb(199, 199, 199); font-size: 12px">
      Total of {{ this.urls ? this.urls.length : "" }} urls
    </p>
  </div>

  <div class="url-util">
    <p-button class="url-util-add" (click)="toggleUrlForm()"
      >Add URL(s)</p-button
    >

    <p-button (onClick)="confirm1($event)" label="Delete All" severity="danger">
    </p-button>
    <p-confirmpopup />
  </div>

  <div class="url-grid">
    @if (loadingService.isLoading$ | async) {
      <p-progress-spinner
        strokeWidth="5"
        fill="transparent"
        animationDuration=".75s"
        [style]="{ width: '35px', height: '35px' }"
      />
    }

    @for (u of this.urls; track u) {
      <div class="url-item">
        <div class="url-options">
          <span class="material-icons-round" (click)="copyUrl(u.url)">
            content_copy
          </span>
          <span
            class="material-icons-round url-delete"
            (click)="deleteUrl(u.id)"
          >
            close
          </span>
        </div>
        <a [href]="u.url" target="_blank" class="url-details">
          <img
            [src]="'https://www.google.com/s2/favicons?domain=' + u.url"
            alt="favicon"
          />

          <span>
            <h1 class="url-title">{{ u.title | slice: 0 : 125 }}</h1>
            <p class="url">{{ u.url }}</p>
          </span>
        </a>
      </div>
    }
  </div>
</main>

<!-- Add URL Form -->
<p-dialog
  header="Add URL(s)"
  [modal]="true"
  [(visible)]="urlFormPop"
  [style]="{ width: '25rem' }"
>
  <form [formGroup]="urlForm" (submit)="submitUrlForm()">
    <div class="items-center gap-4 mb-4">
      <p>Invalid urls may be omitted</p>

      <p style="margin-top: 10px">
        Example: <br />
        https://url.com <br />
        https://url.com
      </p>
    </div>

    <div class="flex items-center gap-4 mb-4">
      <textarea
        #urls
        formControlName="urls"
        rows="4"
        cols="50"
        placeholder="URLs"
        pTextarea
        [autoResize]="true"
      ></textarea>
    </div>

    <p-button label="Submit" type="submit" [disabled]="!urlForm.dirty" />
  </form>
</p-dialog>
